import{f as c}from"./fetch-BU9L-ehW.js";const l=(n,t)=>{document.getElementById(n).innerText=t},u=()=>{localStorage.removeItem("token"),l("clearResponse","localStorage cleared!")},i=document.querySelector(".createuser");i.addEventListener("click",async n=>{n.preventDefault(),console.log("Yritetään luoda käyttäjä");const t="https://hyte-server-teacher.northeurope.cloudapp.azure.com/api/users",e=document.querySelector(".create_user_form");if(!e.checkValidity()){e.reportValidity();return}console.log("Tiedot valideja, jatketaan");const s={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value,email:e.querySelector("input[name=email]").value},o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};try{const a=await c(t,o);console.log(a),alert(a.message)}catch(a){console.error(a.response)}});const m=document.querySelector(".loginuser");m.addEventListener("click",async n=>{n.preventDefault(),console.log("Nyt logataan sisään");const t="https://hyte-server-teacher.northeurope.cloudapp.azure.com/api/auth/login",e=document.querySelector(".login_form"),r={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};c(t,s).then(o=>{console.log(o),console.log(o.token),localStorage.setItem("token",o.token),o.token==null?alert("Unauth user: käyttäjänimi tai salasana ei oikein"):(alert(o.message),localStorage.setItem("name",o.user.username)),l("loginResponse",`localStorage set with token value: ${o.token}`)})});const p=document.querySelector("#meRequest");p.addEventListener("click",async()=>{console.log("Testataan TOKENIA ja haetaan käyttäjän tiedot");const n="https://hyte-server-teacher.northeurope.cloudapp.azure.com/api/auth/me",t=localStorage.getItem("token");console.log("Tämä on haettu LocalStoragesta",t);const e={method:"GET",headers:{Authorization:"Bearer: "+t}};console.log(e),c(n,e).then(r=>{console.log(r),l("meResponse",`Authorized user info: ${JSON.stringify(r)}`)})});const d=document.querySelector("#clearButton");d.addEventListener("click",u);
